from django.core.management.base import BaseCommand
from apps.reference.models import FederalDistrict, Region

DISTRICTS_AND_REGIONS = {
    "ЦФО": {
        "code": "CFO",
        "short": "ЦФО",
        "regions": [
            "Белгородская область", "Брянская область", "Владимирская область",
            "Воронежская область", "Ивановская область", "Калужская область",
            "Костромская область", "Курская область", "Липецкая область",
            "Московская область", "Орловская область", "Рязанская область",
            "Смоленская область", "Тамбовская область", "Тверская область",
            "Тульская область", "Ярославская область", "г. Москва",
        ],
    },
    "Северо-Западный федеральный округ": {
        "code": "SZFO",
        "short": "СЗФО",
        "regions": [
            "Республика Карелия", "Республика Коми",
            "Архангельская область", "Вологодская область",
            "Калининградская область", "Ленинградская область",
            "Мурманская область", "Новгородская область",
            "Псковская область", "г. Санкт-Петербург",
            "Ненецкий автономный округ",
        ],
    },
    "Южный федеральный округ": {
        "code": "UFO_SOUTH",
        "short": "ЮФО",
        "regions": [
            "Республика Адыгея", "Республика Калмыкия",
            "Республика Крым", "Краснодарский край",
            "Астраханская область", "Волгоградская область",
            "Ростовская область", "г. Севастополь",
        ],
    },
    "Северо-Кавказский федеральный округ": {
        "code": "SKFO",
        "short": "СКФО",
        "regions": [
            "Республика Дагестан", "Республика Ингушетия",
            "Кабардино-Балкарская Республика",
            "Карачаево-Черкесская Республика",
            "Республика Северная Осетия - Алания",
            "Чеченская Республика", "Ставропольский край",
        ],
    },
    "Приволжский федеральный округ": {
        "code": "PFO",
        "short": "ПФО",
        "regions": [
            "Республика Башкортостан", "Республика Марий Эл",
            "Республика Мордовия", "Республика Татарстан (Татарстан)",
            "Удмуртская Республика", "Чувашская Республика - Чувашия",
            "Пермский край", "Кировская область",
            "Нижегородская область", "Оренбургская область",
            "Пензенская область", "Самарская область",
            "Саратовская область", "Ульяновская область",
        ],
    },
    "Уральский федеральный округ": {
        "code": "URFO",
        "short": "УрФО",
        "regions": [
            "Курганская область", "Свердловская область",
            "Тюменская область", "Челябинская область",
            "Ханты-Мансийский АО - Югра",
            "Ямало-Ненецкий автономный округ",
        ],
    },
    "Сибирский федеральный округ": {
        "code": "SFO",
        "short": "СФО",
        "regions": [
            "Республика Алтай", "Республика Тыва",
            "Республика Хакасия", "Алтайский край",
            "Красноярский край", "Иркутская область",
            "Кемеровская область", "Новосибирская область",
            "Омская область", "Томская область",
        ],
    },
    "Дальневосточный федеральный округ": {
        "code": "DFO",
        "short": "ДФО",
        "regions": [
            "Республика Бурятия", "Республика Саха (Якутия)",
            "Забайкальский край", "Камчатский край",
            "Приморский край", "Хабаровский край",
            "Амурская область", "Магаданская область",
            "Сахалинская область", "Еврейская автономная область",
            "Чукотский автономный округ",
        ],
    },
    "Новые территории": {
        "code": "NEW",
        "short": "НТ",
        "regions": [
            "Донецкая Народная Республика",
            "Луганская Народная Республика",
            "Запорожская область",
            "Херсонская область",
        ],
    },
}


class Command(BaseCommand):
    help = "Load federal districts and regions of Russia"

    def handle(self, *args, **options):
        total_regions = 0
        for district_name, data in DISTRICTS_AND_REGIONS.items():
            district, created = FederalDistrict.objects.update_or_create(
                code=data["code"],
                defaults={
                    "name": district_name,
                    "short_name": data["short"],
                },
            )
            action = "Created" if created else "Updated"
            self.stdout.write(f"  {action} district: {district_name}")

            for region_name in data["regions"]:
                _, r_created = Region.objects.update_or_create(
                    name=region_name,
                    defaults={"federal_district": district},
                )
                total_regions += 1

        self.stdout.write(
            self.style.SUCCESS(
                f"Loaded {len(DISTRICTS_AND_REGIONS)} districts, "
                f"{total_regions} regions"
            )
        )
